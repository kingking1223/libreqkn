{"ast":null,"code":"var __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n    return t;\n  };\n  return __assign.apply(this, arguments);\n};\nvar __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {\n  function adopt(value) {\n    return value instanceof P ? value : new P(function (resolve) {\n      resolve(value);\n    });\n  }\n  return new (P || (P = Promise))(function (resolve, reject) {\n    function fulfilled(value) {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n    function rejected(value) {\n      try {\n        step(generator[\"throw\"](value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n    function step(result) {\n      result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected);\n    }\n    step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n};\nvar __generator = this && this.__generator || function (thisArg, body) {\n  var _ = {\n      label: 0,\n      sent: function () {\n        if (t[0] & 1) throw t[1];\n        return t[1];\n      },\n      trys: [],\n      ops: []\n    },\n    f,\n    y,\n    t,\n    g;\n  return g = {\n    next: verb(0),\n    \"throw\": verb(1),\n    \"return\": verb(2)\n  }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function () {\n    return this;\n  }), g;\n  function verb(n) {\n    return function (v) {\n      return step([n, v]);\n    };\n  }\n  function step(op) {\n    if (f) throw new TypeError(\"Generator is already executing.\");\n    while (_) try {\n      if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n      if (y = 0, t) op = [op[0] & 2, t.value];\n      switch (op[0]) {\n        case 0:\n        case 1:\n          t = op;\n          break;\n        case 4:\n          _.label++;\n          return {\n            value: op[1],\n            done: false\n          };\n        case 5:\n          _.label++;\n          y = op[1];\n          op = [0];\n          continue;\n        case 7:\n          op = _.ops.pop();\n          _.trys.pop();\n          continue;\n        default:\n          if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) {\n            _ = 0;\n            continue;\n          }\n          if (op[0] === 3 && (!t || op[1] > t[0] && op[1] < t[3])) {\n            _.label = op[1];\n            break;\n          }\n          if (op[0] === 6 && _.label < t[1]) {\n            _.label = t[1];\n            t = op;\n            break;\n          }\n          if (t && _.label < t[2]) {\n            _.label = t[2];\n            _.ops.push(op);\n            break;\n          }\n          if (t[2]) _.ops.pop();\n          _.trys.pop();\n          continue;\n      }\n      op = body.call(thisArg, _);\n    } catch (e) {\n      op = [6, e];\n      y = 0;\n    } finally {\n      f = t = 0;\n    }\n    if (op[0] & 5) throw op[1];\n    return {\n      value: op[0] ? op[1] : void 0,\n      done: true\n    };\n  }\n};\nimport React, { useCallback, useEffect, useMemo, useRef, useState } from 'react';\nimport { Virtuoso } from 'react-virtuoso';\nimport { GiphyPreviewMessage as DefaultGiphyPreviewMessage } from './GiphyPreviewMessage';\nimport { useGiphyPreview } from './hooks/useGiphyPreview';\nimport { useNewMessageNotification } from './hooks/useNewMessageNotification';\nimport { usePrependedMessagesCount } from './hooks/usePrependMessagesCount';\nimport { useShouldForceScrollToBottom } from './hooks/useShouldForceScrollToBottom';\nimport { MessageNotification as DefaultMessageNotification } from './MessageNotification';\nimport { MessageListNotifications as DefaultMessageListNotifications } from './MessageListNotifications';\nimport { processMessages } from './utils';\nimport { CUSTOM_MESSAGE_TYPE } from '../../constants/messageTypes';\nimport { DateSeparator as DefaultDateSeparator } from '../DateSeparator/DateSeparator';\nimport { EmptyStateIndicator as DefaultEmptyStateIndicator } from '../EmptyStateIndicator/EmptyStateIndicator';\nimport { EventComponent } from '../EventComponent/EventComponent';\nimport { LoadingIndicator as DefaultLoadingIndicator } from '../Loading/LoadingIndicator';\nimport { Message, MessageSimple } from '../Message';\nimport { useChannelActionContext } from '../../context/ChannelActionContext';\nimport { useChannelStateContext } from '../../context/ChannelStateContext';\nimport { useChatContext } from '../../context/ChatContext';\nimport { useComponentContext } from '../../context/ComponentContext';\nimport { isDate } from '../../context/TranslationContext';\nvar PREPEND_OFFSET = Math.pow(10, 7);\nfunction captureResizeObserverExceededError(e) {\n  if (e.message === 'ResizeObserver loop completed with undelivered notifications.' || e.message === 'ResizeObserver loop limit exceeded') {\n    e.stopImmediatePropagation();\n  }\n}\nfunction useCaptureResizeObserverExceededError() {\n  useEffect(function () {\n    window.addEventListener('error', captureResizeObserverExceededError);\n    return function () {\n      window.removeEventListener('error', captureResizeObserverExceededError);\n    };\n  }, []);\n}\nfunction fractionalItemSize(element) {\n  return element.getBoundingClientRect().height;\n}\nfunction findMessageIndex(messages, id) {\n  return messages.findIndex(function (message) {\n    return message.id === id;\n  });\n}\nfunction calculateInitialTopMostItemIndex(messages, highlightedMessageId) {\n  if (highlightedMessageId) {\n    var index = findMessageIndex(messages, highlightedMessageId);\n    if (index !== -1) {\n      return {\n        align: 'center',\n        index: index\n      };\n    }\n  }\n  return messages.length - 1;\n}\nvar VirtualizedMessageListWithContext = function (props) {\n  var additionalVirtuosoProps = props.additionalVirtuosoProps,\n    channel = props.channel,\n    closeReactionSelectorOnClick = props.closeReactionSelectorOnClick,\n    customMessageRenderer = props.customMessageRenderer,\n    defaultItemHeight = props.defaultItemHeight,\n    _a = props.disableDateSeparator,\n    disableDateSeparator = _a === void 0 ? true : _a,\n    hasMore = props.hasMore,\n    hasMoreNewer = props.hasMoreNewer,\n    _b = props.hideDeletedMessages,\n    hideDeletedMessages = _b === void 0 ? false : _b,\n    _c = props.hideNewMessageSeparator,\n    hideNewMessageSeparator = _c === void 0 ? false : _c,\n    highlightedMessageId = props.highlightedMessageId,\n    jumpToLatestMessage = props.jumpToLatestMessage,\n    loadingMore = props.loadingMore,\n    loadMore = props.loadMore,\n    loadMoreNewer = props.loadMoreNewer,\n    propMessage = props.Message,\n    _d = props.messageLimit,\n    messageLimit = _d === void 0 ? 100 : _d,\n    messages = props.messages,\n    notifications = props.notifications,\n    // TODO: refactor to scrollSeekPlaceHolderConfiguration and components.ScrollSeekPlaceholder, like the Virtuoso Component\n    _e = props.overscan,\n    // TODO: refactor to scrollSeekPlaceHolderConfiguration and components.ScrollSeekPlaceholder, like the Virtuoso Component\n    overscan = _e === void 0 ? 0 : _e,\n    scrollSeekPlaceHolder = props.scrollSeekPlaceHolder,\n    _f = props.scrollToLatestMessageOnFocus,\n    scrollToLatestMessageOnFocus = _f === void 0 ? false : _f,\n    _g = props.separateGiphyPreview,\n    separateGiphyPreview = _g === void 0 ? false : _g,\n    _h = props.shouldGroupByUser,\n    shouldGroupByUser = _h === void 0 ? false : _h,\n    _j = props.stickToBottomScrollBehavior,\n    stickToBottomScrollBehavior = _j === void 0 ? 'smooth' : _j,\n    suppressAutoscroll = props.suppressAutoscroll;\n  // Stops errors generated from react-virtuoso to bubble up\n  // to Sentry or other tracking tools.\n  useCaptureResizeObserverExceededError();\n  var _k = useComponentContext('VirtualizedMessageList'),\n    _l = _k.DateSeparator,\n    DateSeparator = _l === void 0 ? DefaultDateSeparator : _l,\n    _m = _k.EmptyStateIndicator,\n    EmptyStateIndicator = _m === void 0 ? DefaultEmptyStateIndicator : _m,\n    _o = _k.GiphyPreviewMessage,\n    GiphyPreviewMessage = _o === void 0 ? DefaultGiphyPreviewMessage : _o,\n    _p = _k.LoadingIndicator,\n    LoadingIndicator = _p === void 0 ? DefaultLoadingIndicator : _p,\n    _q = _k.MessageListNotifications,\n    MessageListNotifications = _q === void 0 ? DefaultMessageListNotifications : _q,\n    _r = _k.MessageNotification,\n    MessageNotification = _r === void 0 ? DefaultMessageNotification : _r,\n    _s = _k.MessageSystem,\n    MessageSystem = _s === void 0 ? EventComponent : _s,\n    _t = _k.TypingIndicator,\n    TypingIndicator = _t === void 0 ? null : _t,\n    _u = _k.VirtualMessage,\n    contextMessage = _u === void 0 ? MessageSimple : _u;\n  var _v = useChatContext('VirtualizedMessageList'),\n    client = _v.client,\n    customClasses = _v.customClasses;\n  var lastRead = useMemo(function () {\n    var _a;\n    return (_a = channel.lastRead) === null || _a === void 0 ? void 0 : _a.call(channel);\n  }, [channel]);\n  var MessageUIComponent = propMessage || contextMessage;\n  var _w = useGiphyPreview(separateGiphyPreview),\n    giphyPreviewMessage = _w.giphyPreviewMessage,\n    setGiphyPreviewMessage = _w.setGiphyPreviewMessage;\n  var processedMessages = useMemo(function () {\n    if (typeof messages === 'undefined') {\n      return [];\n    }\n    if (disableDateSeparator && !hideDeletedMessages && hideNewMessageSeparator && !separateGiphyPreview) {\n      return messages;\n    }\n    return processMessages({\n      enableDateSeparator: !disableDateSeparator,\n      hideDeletedMessages: hideDeletedMessages,\n      hideNewMessageSeparator: hideNewMessageSeparator,\n      lastRead: lastRead,\n      messages: messages,\n      setGiphyPreviewMessage: setGiphyPreviewMessage,\n      userId: client.userID || ''\n    });\n  }, [disableDateSeparator, hideDeletedMessages, hideNewMessageSeparator, lastRead, messages, messages === null || messages === void 0 ? void 0 : messages.length, client.userID]);\n  var virtuoso = useRef(null);\n  var _x = useNewMessageNotification(processedMessages, client.userID, hasMoreNewer),\n    atBottom = _x.atBottom,\n    newMessagesNotification = _x.newMessagesNotification,\n    setNewMessagesNotification = _x.setNewMessagesNotification;\n  var scrollToBottom = useCallback(function () {\n    return __awaiter(void 0, void 0, void 0, function () {\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            if (!hasMoreNewer) return [3 /*break*/, 2];\n            return [4 /*yield*/, jumpToLatestMessage()];\n          case 1:\n            _a.sent();\n            return [2 /*return*/];\n          case 2:\n            if (virtuoso.current) {\n              virtuoso.current.scrollToIndex(processedMessages.length - 1);\n            }\n            setNewMessagesNotification(false);\n            return [2 /*return*/];\n        }\n      });\n    });\n  }, [virtuoso, processedMessages, setNewMessagesNotification, processedMessages.length, hasMoreNewer, jumpToLatestMessage]);\n  var _y = React.useState(false),\n    newMessagesReceivedInBackground = _y[0],\n    setNewMessagesReceivedInBackground = _y[1];\n  var resetNewMessagesReceivedInBackground = useCallback(function () {\n    setNewMessagesReceivedInBackground(false);\n  }, []);\n  useEffect(function () {\n    setNewMessagesReceivedInBackground(true);\n  }, [messages]);\n  var scrollToBottomIfConfigured = useCallback(function (event) {\n    if (scrollToLatestMessageOnFocus && event.target === window) {\n      if (newMessagesReceivedInBackground) {\n        setTimeout(scrollToBottom, 100);\n      }\n    }\n  }, [scrollToLatestMessageOnFocus, scrollToBottom, newMessagesReceivedInBackground]);\n  useEffect(function () {\n    if (typeof window !== 'undefined') {\n      window.addEventListener('focus', scrollToBottomIfConfigured);\n      window.addEventListener('blur', resetNewMessagesReceivedInBackground);\n    }\n    return function () {\n      window.removeEventListener('focus', scrollToBottomIfConfigured);\n      window.removeEventListener('blur', resetNewMessagesReceivedInBackground);\n    };\n  }, [scrollToBottomIfConfigured]);\n  var numItemsPrepended = usePrependedMessagesCount(processedMessages, !disableDateSeparator);\n  /**\n   * Logic to update the key of the virtuoso component when the list jumps to a new location.\n   */\n  var _z = useState(+new Date()),\n    messageSetKey = _z[0],\n    setMessageSetKey = _z[1];\n  var firstMessageId = useRef();\n  useEffect(function () {\n    var _a;\n    var continuousSet = messages === null || messages === void 0 ? void 0 : messages.find(function (message) {\n      return message.id === firstMessageId.current;\n    });\n    if (!continuousSet) {\n      setMessageSetKey(+new Date());\n    }\n    firstMessageId.current = (_a = messages === null || messages === void 0 ? void 0 : messages[0]) === null || _a === void 0 ? void 0 : _a.id;\n  }, [messages]);\n  var shouldForceScrollToBottom = useShouldForceScrollToBottom(processedMessages, client.userID);\n  var followOutput = function (isAtBottom) {\n    if (hasMoreNewer || suppressAutoscroll) {\n      return false;\n    }\n    if (shouldForceScrollToBottom()) {\n      return isAtBottom ? stickToBottomScrollBehavior : 'auto';\n    }\n    // a message from another user has been received - don't scroll to bottom unless already there\n    return isAtBottom ? stickToBottomScrollBehavior : false;\n  };\n  var messageRenderer = useCallback(function (messageList, virtuosoIndex) {\n    var _a, _b, _c, _d, _e, _f, _g, _h, _j;\n    var streamMessageIndex = virtuosoIndex + numItemsPrepended - PREPEND_OFFSET;\n    // use custom renderer supplied by client if present and skip the rest\n    if (customMessageRenderer) {\n      return customMessageRenderer(messageList, streamMessageIndex);\n    }\n    var message = messageList[streamMessageIndex];\n    if (message.customType === CUSTOM_MESSAGE_TYPE.date && message.date && isDate(message.date)) {\n      return React.createElement(DateSeparator, {\n        date: message.date,\n        unread: message.unread\n      });\n    }\n    if (!message) return React.createElement(\"div\", {\n      style: {\n        height: '1px'\n      }\n    }); // returning null or zero height breaks the virtuoso\n    if (message.type === 'system') {\n      return React.createElement(MessageSystem, {\n        message: message\n      });\n    }\n    var groupedByUser = shouldGroupByUser && streamMessageIndex > 0 && ((_a = message.user) === null || _a === void 0 ? void 0 : _a.id) === ((_b = messageList[streamMessageIndex - 1].user) === null || _b === void 0 ? void 0 : _b.id);\n    var firstOfGroup = shouldGroupByUser && ((_c = message.user) === null || _c === void 0 ? void 0 : _c.id) !== ((_e = (_d = messageList[streamMessageIndex - 1]) === null || _d === void 0 ? void 0 : _d.user) === null || _e === void 0 ? void 0 : _e.id);\n    var endOfGroup = shouldGroupByUser && ((_f = message.user) === null || _f === void 0 ? void 0 : _f.id) !== ((_h = (_g = messageList[streamMessageIndex + 1]) === null || _g === void 0 ? void 0 : _g.user) === null || _h === void 0 ? void 0 : _h.id);\n    return React.createElement(Message, {\n      autoscrollToBottom: (_j = virtuoso.current) === null || _j === void 0 ? void 0 : _j.autoscrollToBottom,\n      closeReactionSelectorOnClick: closeReactionSelectorOnClick,\n      customMessageActions: props.customMessageActions,\n      endOfGroup: endOfGroup,\n      firstOfGroup: firstOfGroup,\n      groupedByUser: groupedByUser,\n      message: message,\n      Message: MessageUIComponent,\n      messageActions: props.messageActions\n    });\n  }, [customMessageRenderer, shouldGroupByUser, numItemsPrepended]);\n  var Item = useMemo(function () {\n    // using 'display: inline-block'\n    // traps CSS margins of the item elements, preventing incorrect item measurements\n    var Item = function (props) {\n      return React.createElement(\"div\", __assign({}, props, {\n        className: (customClasses === null || customClasses === void 0 ? void 0 : customClasses.virtualMessage) || 'str-chat__virtual-list-message-wrapper'\n      }));\n    };\n    return Item;\n  }, [customClasses === null || customClasses === void 0 ? void 0 : customClasses.virtualMessage]);\n  var virtuosoComponents = useMemo(function () {\n    var EmptyPlaceholder = function () {\n      return React.createElement(React.Fragment, null, EmptyStateIndicator && React.createElement(EmptyStateIndicator, {\n        listType: 'message'\n      }));\n    };\n    var Header = function () {\n      return loadingMore ? React.createElement(\"div\", {\n        className: 'str-chat__virtual-list__loading'\n      }, React.createElement(LoadingIndicator, {\n        size: 20\n      })) : React.createElement(React.Fragment, null);\n    };\n    var Footer = function () {\n      return TypingIndicator ? React.createElement(TypingIndicator, {\n        avatarSize: 24\n      }) : React.createElement(React.Fragment, null);\n    };\n    return {\n      EmptyPlaceholder: EmptyPlaceholder,\n      Footer: Footer,\n      Header: Header,\n      Item: Item\n    };\n  }, [loadingMore]);\n  var atBottomStateChange = function (isAtBottom) {\n    atBottom.current = isAtBottom;\n    if (isAtBottom && newMessagesNotification) {\n      setNewMessagesNotification(false);\n    }\n  };\n  var startReached = function () {\n    if (hasMore && loadMore) {\n      loadMore(messageLimit);\n    }\n  };\n  var endReached = function () {\n    if (hasMoreNewer && loadMoreNewer) {\n      loadMoreNewer(messageLimit);\n    }\n  };\n  useEffect(function () {\n    var _a;\n    if (highlightedMessageId) {\n      var index = findMessageIndex(processedMessages, highlightedMessageId);\n      if (index !== -1) {\n        (_a = virtuoso.current) === null || _a === void 0 ? void 0 : _a.scrollToIndex({\n          align: 'center',\n          index: index\n        });\n      }\n    }\n  }, [highlightedMessageId]);\n  if (!processedMessages) return null;\n  return React.createElement(React.Fragment, null, React.createElement(\"div\", {\n    className: (customClasses === null || customClasses === void 0 ? void 0 : customClasses.virtualizedMessageList) || 'str-chat__virtual-list'\n  }, React.createElement(Virtuoso, __assign({\n    atBottomStateChange: atBottomStateChange,\n    components: virtuosoComponents,\n    computeItemKey: function (index) {\n      return processedMessages[numItemsPrepended + index - PREPEND_OFFSET].id;\n    },\n    endReached: endReached,\n    firstItemIndex: PREPEND_OFFSET - numItemsPrepended,\n    followOutput: followOutput,\n    increaseViewportBy: {\n      bottom: 200,\n      top: 0\n    },\n    initialTopMostItemIndex: calculateInitialTopMostItemIndex(processedMessages, highlightedMessageId),\n    itemContent: function (i) {\n      return messageRenderer(processedMessages, i);\n    },\n    itemSize: fractionalItemSize,\n    key: messageSetKey,\n    overscan: overscan,\n    ref: virtuoso,\n    startReached: startReached,\n    style: {\n      overflowX: 'hidden'\n    },\n    totalCount: processedMessages.length\n  }, additionalVirtuosoProps, scrollSeekPlaceHolder ? {\n    scrollSeek: scrollSeekPlaceHolder\n  } : {}, defaultItemHeight ? {\n    defaultItemHeight: defaultItemHeight\n  } : {}))), React.createElement(MessageListNotifications, {\n    hasNewMessages: newMessagesNotification,\n    isNotAtLatestMessageSet: hasMoreNewer,\n    MessageNotification: MessageNotification,\n    notifications: notifications,\n    scrollToBottom: scrollToBottom\n  }), giphyPreviewMessage && React.createElement(GiphyPreviewMessage, {\n    message: giphyPreviewMessage\n  }));\n};\n/**\n * The VirtualizedMessageList component renders a list of messages in a virtualized list.\n * It is a consumer of the React contexts set in [Channel](https://github.com/GetStream/stream-chat-react/blob/master/src/components/Channel/Channel.tsx).\n */\nexport function VirtualizedMessageList(props) {\n  var _a = useChannelActionContext('VirtualizedMessageList'),\n    jumpToLatestMessage = _a.jumpToLatestMessage,\n    loadMore = _a.loadMore,\n    loadMoreNewer = _a.loadMoreNewer;\n  var _b = useChannelStateContext('VirtualizedMessageList'),\n    channel = _b.channel,\n    hasMore = _b.hasMore,\n    hasMoreNewer = _b.hasMoreNewer,\n    highlightedMessageId = _b.highlightedMessageId,\n    loadingMore = _b.loadingMore,\n    loadingMoreNewer = _b.loadingMoreNewer,\n    contextMessages = _b.messages,\n    notifications = _b.notifications,\n    suppressAutoscroll = _b.suppressAutoscroll;\n  var messages = props.messages || contextMessages;\n  return React.createElement(VirtualizedMessageListWithContext, __assign({\n    channel: channel,\n    hasMore: !!hasMore,\n    hasMoreNewer: !!hasMoreNewer,\n    highlightedMessageId: highlightedMessageId,\n    jumpToLatestMessage: jumpToLatestMessage,\n    loadingMore: !!loadingMore,\n    loadingMoreNewer: !!loadingMoreNewer,\n    loadMore: loadMore,\n    loadMoreNewer: loadMoreNewer,\n    messages: messages,\n    notifications: notifications,\n    suppressAutoscroll: suppressAutoscroll\n  }, props));\n}","map":{"version":3,"names":["__assign","Object","assign","t","s","i","n","arguments","length","p","prototype","hasOwnProperty","call","apply","__awaiter","thisArg","_arguments","P","generator","adopt","value","resolve","Promise","reject","fulfilled","step","next","e","rejected","result","done","then","__generator","body","_","label","sent","trys","ops","f","y","g","verb","Symbol","iterator","v","op","TypeError","pop","push","React","useCallback","useEffect","useMemo","useRef","useState","Virtuoso","GiphyPreviewMessage","DefaultGiphyPreviewMessage","useGiphyPreview","useNewMessageNotification","usePrependedMessagesCount","useShouldForceScrollToBottom","MessageNotification","DefaultMessageNotification","MessageListNotifications","DefaultMessageListNotifications","processMessages","CUSTOM_MESSAGE_TYPE","DateSeparator","DefaultDateSeparator","EmptyStateIndicator","DefaultEmptyStateIndicator","EventComponent","LoadingIndicator","DefaultLoadingIndicator","Message","MessageSimple","useChannelActionContext","useChannelStateContext","useChatContext","useComponentContext","isDate","PREPEND_OFFSET","Math","pow","captureResizeObserverExceededError","message","stopImmediatePropagation","useCaptureResizeObserverExceededError","window","addEventListener","removeEventListener","fractionalItemSize","element","getBoundingClientRect","height","findMessageIndex","messages","id","findIndex","calculateInitialTopMostItemIndex","highlightedMessageId","index","align","VirtualizedMessageListWithContext","props","additionalVirtuosoProps","channel","closeReactionSelectorOnClick","customMessageRenderer","defaultItemHeight","_a","disableDateSeparator","hasMore","hasMoreNewer","_b","hideDeletedMessages","_c","hideNewMessageSeparator","jumpToLatestMessage","loadingMore","loadMore","loadMoreNewer","propMessage","_d","messageLimit","notifications","_e","overscan","scrollSeekPlaceHolder","_f","scrollToLatestMessageOnFocus","_g","separateGiphyPreview","_h","shouldGroupByUser","_j","stickToBottomScrollBehavior","suppressAutoscroll","_k","_l","_m","_o","_p","_q","_r","_s","MessageSystem","_t","TypingIndicator","_u","VirtualMessage","contextMessage","_v","client","customClasses","lastRead","MessageUIComponent","_w","giphyPreviewMessage","setGiphyPreviewMessage","processedMessages","enableDateSeparator","userId","userID","virtuoso","_x","atBottom","newMessagesNotification","setNewMessagesNotification","scrollToBottom","current","scrollToIndex","_y","newMessagesReceivedInBackground","setNewMessagesReceivedInBackground","resetNewMessagesReceivedInBackground","scrollToBottomIfConfigured","event","target","setTimeout","numItemsPrepended","_z","Date","messageSetKey","setMessageSetKey","firstMessageId","continuousSet","find","shouldForceScrollToBottom","followOutput","isAtBottom","messageRenderer","messageList","virtuosoIndex","streamMessageIndex","customType","date","createElement","unread","style","type","groupedByUser","user","firstOfGroup","endOfGroup","autoscrollToBottom","customMessageActions","messageActions","Item","className","virtualMessage","virtuosoComponents","EmptyPlaceholder","Fragment","listType","Header","size","Footer","avatarSize","atBottomStateChange","startReached","endReached","virtualizedMessageList","components","computeItemKey","firstItemIndex","increaseViewportBy","bottom","top","initialTopMostItemIndex","itemContent","itemSize","key","ref","overflowX","totalCount","scrollSeek","hasNewMessages","isNotAtLatestMessageSet","VirtualizedMessageList","loadingMoreNewer","contextMessages"],"sources":["/home/kingking/Documents/code/website/libreqkn/client/node_modules/stream-chat-react/dist/components/MessageList/VirtualizedMessageList.js"],"sourcesContent":["var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nimport React, { useCallback, useEffect, useMemo, useRef, useState } from 'react';\nimport { Virtuoso, } from 'react-virtuoso';\nimport { GiphyPreviewMessage as DefaultGiphyPreviewMessage } from './GiphyPreviewMessage';\nimport { useGiphyPreview } from './hooks/useGiphyPreview';\nimport { useNewMessageNotification } from './hooks/useNewMessageNotification';\nimport { usePrependedMessagesCount } from './hooks/usePrependMessagesCount';\nimport { useShouldForceScrollToBottom } from './hooks/useShouldForceScrollToBottom';\nimport { MessageNotification as DefaultMessageNotification } from './MessageNotification';\nimport { MessageListNotifications as DefaultMessageListNotifications } from './MessageListNotifications';\nimport { processMessages } from './utils';\nimport { CUSTOM_MESSAGE_TYPE } from '../../constants/messageTypes';\nimport { DateSeparator as DefaultDateSeparator } from '../DateSeparator/DateSeparator';\nimport { EmptyStateIndicator as DefaultEmptyStateIndicator } from '../EmptyStateIndicator/EmptyStateIndicator';\nimport { EventComponent } from '../EventComponent/EventComponent';\nimport { LoadingIndicator as DefaultLoadingIndicator } from '../Loading/LoadingIndicator';\nimport { Message, MessageSimple } from '../Message';\nimport { useChannelActionContext, } from '../../context/ChannelActionContext';\nimport { useChannelStateContext, } from '../../context/ChannelStateContext';\nimport { useChatContext } from '../../context/ChatContext';\nimport { useComponentContext } from '../../context/ComponentContext';\nimport { isDate } from '../../context/TranslationContext';\nvar PREPEND_OFFSET = Math.pow(10, 7);\nfunction captureResizeObserverExceededError(e) {\n    if (e.message === 'ResizeObserver loop completed with undelivered notifications.' ||\n        e.message === 'ResizeObserver loop limit exceeded') {\n        e.stopImmediatePropagation();\n    }\n}\nfunction useCaptureResizeObserverExceededError() {\n    useEffect(function () {\n        window.addEventListener('error', captureResizeObserverExceededError);\n        return function () {\n            window.removeEventListener('error', captureResizeObserverExceededError);\n        };\n    }, []);\n}\nfunction fractionalItemSize(element) {\n    return element.getBoundingClientRect().height;\n}\nfunction findMessageIndex(messages, id) {\n    return messages.findIndex(function (message) { return message.id === id; });\n}\nfunction calculateInitialTopMostItemIndex(messages, highlightedMessageId) {\n    if (highlightedMessageId) {\n        var index = findMessageIndex(messages, highlightedMessageId);\n        if (index !== -1) {\n            return { align: 'center', index: index };\n        }\n    }\n    return messages.length - 1;\n}\nvar VirtualizedMessageListWithContext = function (props) {\n    var additionalVirtuosoProps = props.additionalVirtuosoProps, channel = props.channel, closeReactionSelectorOnClick = props.closeReactionSelectorOnClick, customMessageRenderer = props.customMessageRenderer, defaultItemHeight = props.defaultItemHeight, _a = props.disableDateSeparator, disableDateSeparator = _a === void 0 ? true : _a, hasMore = props.hasMore, hasMoreNewer = props.hasMoreNewer, _b = props.hideDeletedMessages, hideDeletedMessages = _b === void 0 ? false : _b, _c = props.hideNewMessageSeparator, hideNewMessageSeparator = _c === void 0 ? false : _c, highlightedMessageId = props.highlightedMessageId, jumpToLatestMessage = props.jumpToLatestMessage, loadingMore = props.loadingMore, loadMore = props.loadMore, loadMoreNewer = props.loadMoreNewer, propMessage = props.Message, _d = props.messageLimit, messageLimit = _d === void 0 ? 100 : _d, messages = props.messages, notifications = props.notifications, \n    // TODO: refactor to scrollSeekPlaceHolderConfiguration and components.ScrollSeekPlaceholder, like the Virtuoso Component\n    _e = props.overscan, \n    // TODO: refactor to scrollSeekPlaceHolderConfiguration and components.ScrollSeekPlaceholder, like the Virtuoso Component\n    overscan = _e === void 0 ? 0 : _e, scrollSeekPlaceHolder = props.scrollSeekPlaceHolder, _f = props.scrollToLatestMessageOnFocus, scrollToLatestMessageOnFocus = _f === void 0 ? false : _f, _g = props.separateGiphyPreview, separateGiphyPreview = _g === void 0 ? false : _g, _h = props.shouldGroupByUser, shouldGroupByUser = _h === void 0 ? false : _h, _j = props.stickToBottomScrollBehavior, stickToBottomScrollBehavior = _j === void 0 ? 'smooth' : _j, suppressAutoscroll = props.suppressAutoscroll;\n    // Stops errors generated from react-virtuoso to bubble up\n    // to Sentry or other tracking tools.\n    useCaptureResizeObserverExceededError();\n    var _k = useComponentContext('VirtualizedMessageList'), _l = _k.DateSeparator, DateSeparator = _l === void 0 ? DefaultDateSeparator : _l, _m = _k.EmptyStateIndicator, EmptyStateIndicator = _m === void 0 ? DefaultEmptyStateIndicator : _m, _o = _k.GiphyPreviewMessage, GiphyPreviewMessage = _o === void 0 ? DefaultGiphyPreviewMessage : _o, _p = _k.LoadingIndicator, LoadingIndicator = _p === void 0 ? DefaultLoadingIndicator : _p, _q = _k.MessageListNotifications, MessageListNotifications = _q === void 0 ? DefaultMessageListNotifications : _q, _r = _k.MessageNotification, MessageNotification = _r === void 0 ? DefaultMessageNotification : _r, _s = _k.MessageSystem, MessageSystem = _s === void 0 ? EventComponent : _s, _t = _k.TypingIndicator, TypingIndicator = _t === void 0 ? null : _t, _u = _k.VirtualMessage, contextMessage = _u === void 0 ? MessageSimple : _u;\n    var _v = useChatContext('VirtualizedMessageList'), client = _v.client, customClasses = _v.customClasses;\n    var lastRead = useMemo(function () { var _a; return (_a = channel.lastRead) === null || _a === void 0 ? void 0 : _a.call(channel); }, [channel]);\n    var MessageUIComponent = propMessage || contextMessage;\n    var _w = useGiphyPreview(separateGiphyPreview), giphyPreviewMessage = _w.giphyPreviewMessage, setGiphyPreviewMessage = _w.setGiphyPreviewMessage;\n    var processedMessages = useMemo(function () {\n        if (typeof messages === 'undefined') {\n            return [];\n        }\n        if (disableDateSeparator &&\n            !hideDeletedMessages &&\n            hideNewMessageSeparator &&\n            !separateGiphyPreview) {\n            return messages;\n        }\n        return processMessages({\n            enableDateSeparator: !disableDateSeparator,\n            hideDeletedMessages: hideDeletedMessages,\n            hideNewMessageSeparator: hideNewMessageSeparator,\n            lastRead: lastRead,\n            messages: messages,\n            setGiphyPreviewMessage: setGiphyPreviewMessage,\n            userId: client.userID || '',\n        });\n    }, [\n        disableDateSeparator,\n        hideDeletedMessages,\n        hideNewMessageSeparator,\n        lastRead,\n        messages,\n        messages === null || messages === void 0 ? void 0 : messages.length,\n        client.userID,\n    ]);\n    var virtuoso = useRef(null);\n    var _x = useNewMessageNotification(processedMessages, client.userID, hasMoreNewer), atBottom = _x.atBottom, newMessagesNotification = _x.newMessagesNotification, setNewMessagesNotification = _x.setNewMessagesNotification;\n    var scrollToBottom = useCallback(function () { return __awaiter(void 0, void 0, void 0, function () {\n        return __generator(this, function (_a) {\n            switch (_a.label) {\n                case 0:\n                    if (!hasMoreNewer) return [3 /*break*/, 2];\n                    return [4 /*yield*/, jumpToLatestMessage()];\n                case 1:\n                    _a.sent();\n                    return [2 /*return*/];\n                case 2:\n                    if (virtuoso.current) {\n                        virtuoso.current.scrollToIndex(processedMessages.length - 1);\n                    }\n                    setNewMessagesNotification(false);\n                    return [2 /*return*/];\n            }\n        });\n    }); }, [\n        virtuoso,\n        processedMessages,\n        setNewMessagesNotification,\n        processedMessages.length,\n        hasMoreNewer,\n        jumpToLatestMessage,\n    ]);\n    var _y = React.useState(false), newMessagesReceivedInBackground = _y[0], setNewMessagesReceivedInBackground = _y[1];\n    var resetNewMessagesReceivedInBackground = useCallback(function () {\n        setNewMessagesReceivedInBackground(false);\n    }, []);\n    useEffect(function () {\n        setNewMessagesReceivedInBackground(true);\n    }, [messages]);\n    var scrollToBottomIfConfigured = useCallback(function (event) {\n        if (scrollToLatestMessageOnFocus && event.target === window) {\n            if (newMessagesReceivedInBackground) {\n                setTimeout(scrollToBottom, 100);\n            }\n        }\n    }, [scrollToLatestMessageOnFocus, scrollToBottom, newMessagesReceivedInBackground]);\n    useEffect(function () {\n        if (typeof window !== 'undefined') {\n            window.addEventListener('focus', scrollToBottomIfConfigured);\n            window.addEventListener('blur', resetNewMessagesReceivedInBackground);\n        }\n        return function () {\n            window.removeEventListener('focus', scrollToBottomIfConfigured);\n            window.removeEventListener('blur', resetNewMessagesReceivedInBackground);\n        };\n    }, [scrollToBottomIfConfigured]);\n    var numItemsPrepended = usePrependedMessagesCount(processedMessages, !disableDateSeparator);\n    /**\n     * Logic to update the key of the virtuoso component when the list jumps to a new location.\n     */\n    var _z = useState(+new Date()), messageSetKey = _z[0], setMessageSetKey = _z[1];\n    var firstMessageId = useRef();\n    useEffect(function () {\n        var _a;\n        var continuousSet = messages === null || messages === void 0 ? void 0 : messages.find(function (message) { return message.id === firstMessageId.current; });\n        if (!continuousSet) {\n            setMessageSetKey(+new Date());\n        }\n        firstMessageId.current = (_a = messages === null || messages === void 0 ? void 0 : messages[0]) === null || _a === void 0 ? void 0 : _a.id;\n    }, [messages]);\n    var shouldForceScrollToBottom = useShouldForceScrollToBottom(processedMessages, client.userID);\n    var followOutput = function (isAtBottom) {\n        if (hasMoreNewer || suppressAutoscroll) {\n            return false;\n        }\n        if (shouldForceScrollToBottom()) {\n            return isAtBottom ? stickToBottomScrollBehavior : 'auto';\n        }\n        // a message from another user has been received - don't scroll to bottom unless already there\n        return isAtBottom ? stickToBottomScrollBehavior : false;\n    };\n    var messageRenderer = useCallback(function (messageList, virtuosoIndex) {\n        var _a, _b, _c, _d, _e, _f, _g, _h, _j;\n        var streamMessageIndex = virtuosoIndex + numItemsPrepended - PREPEND_OFFSET;\n        // use custom renderer supplied by client if present and skip the rest\n        if (customMessageRenderer) {\n            return customMessageRenderer(messageList, streamMessageIndex);\n        }\n        var message = messageList[streamMessageIndex];\n        if (message.customType === CUSTOM_MESSAGE_TYPE.date && message.date && isDate(message.date)) {\n            return React.createElement(DateSeparator, { date: message.date, unread: message.unread });\n        }\n        if (!message)\n            return React.createElement(\"div\", { style: { height: '1px' } }); // returning null or zero height breaks the virtuoso\n        if (message.type === 'system') {\n            return React.createElement(MessageSystem, { message: message });\n        }\n        var groupedByUser = shouldGroupByUser &&\n            streamMessageIndex > 0 &&\n            ((_a = message.user) === null || _a === void 0 ? void 0 : _a.id) === ((_b = messageList[streamMessageIndex - 1].user) === null || _b === void 0 ? void 0 : _b.id);\n        var firstOfGroup = shouldGroupByUser && ((_c = message.user) === null || _c === void 0 ? void 0 : _c.id) !== ((_e = (_d = messageList[streamMessageIndex - 1]) === null || _d === void 0 ? void 0 : _d.user) === null || _e === void 0 ? void 0 : _e.id);\n        var endOfGroup = shouldGroupByUser && ((_f = message.user) === null || _f === void 0 ? void 0 : _f.id) !== ((_h = (_g = messageList[streamMessageIndex + 1]) === null || _g === void 0 ? void 0 : _g.user) === null || _h === void 0 ? void 0 : _h.id);\n        return (React.createElement(Message, { autoscrollToBottom: (_j = virtuoso.current) === null || _j === void 0 ? void 0 : _j.autoscrollToBottom, closeReactionSelectorOnClick: closeReactionSelectorOnClick, customMessageActions: props.customMessageActions, endOfGroup: endOfGroup, firstOfGroup: firstOfGroup, groupedByUser: groupedByUser, message: message, Message: MessageUIComponent, messageActions: props.messageActions }));\n    }, [customMessageRenderer, shouldGroupByUser, numItemsPrepended]);\n    var Item = useMemo(function () {\n        // using 'display: inline-block'\n        // traps CSS margins of the item elements, preventing incorrect item measurements\n        var Item = function (props) { return (React.createElement(\"div\", __assign({}, props, { className: (customClasses === null || customClasses === void 0 ? void 0 : customClasses.virtualMessage) || 'str-chat__virtual-list-message-wrapper' }))); };\n        return Item;\n    }, [customClasses === null || customClasses === void 0 ? void 0 : customClasses.virtualMessage]);\n    var virtuosoComponents = useMemo(function () {\n        var EmptyPlaceholder = function () { return (React.createElement(React.Fragment, null, EmptyStateIndicator && React.createElement(EmptyStateIndicator, { listType: 'message' }))); };\n        var Header = function () {\n            return loadingMore ? (React.createElement(\"div\", { className: 'str-chat__virtual-list__loading' },\n                React.createElement(LoadingIndicator, { size: 20 }))) : (React.createElement(React.Fragment, null));\n        };\n        var Footer = function () {\n            return TypingIndicator ? React.createElement(TypingIndicator, { avatarSize: 24 }) : React.createElement(React.Fragment, null);\n        };\n        return {\n            EmptyPlaceholder: EmptyPlaceholder,\n            Footer: Footer,\n            Header: Header,\n            Item: Item,\n        };\n    }, [loadingMore]);\n    var atBottomStateChange = function (isAtBottom) {\n        atBottom.current = isAtBottom;\n        if (isAtBottom && newMessagesNotification) {\n            setNewMessagesNotification(false);\n        }\n    };\n    var startReached = function () {\n        if (hasMore && loadMore) {\n            loadMore(messageLimit);\n        }\n    };\n    var endReached = function () {\n        if (hasMoreNewer && loadMoreNewer) {\n            loadMoreNewer(messageLimit);\n        }\n    };\n    useEffect(function () {\n        var _a;\n        if (highlightedMessageId) {\n            var index = findMessageIndex(processedMessages, highlightedMessageId);\n            if (index !== -1) {\n                (_a = virtuoso.current) === null || _a === void 0 ? void 0 : _a.scrollToIndex({ align: 'center', index: index });\n            }\n        }\n    }, [highlightedMessageId]);\n    if (!processedMessages)\n        return null;\n    return (React.createElement(React.Fragment, null,\n        React.createElement(\"div\", { className: (customClasses === null || customClasses === void 0 ? void 0 : customClasses.virtualizedMessageList) || 'str-chat__virtual-list' },\n            React.createElement(Virtuoso, __assign({ atBottomStateChange: atBottomStateChange, components: virtuosoComponents, computeItemKey: function (index) {\n                    return processedMessages[numItemsPrepended + index - PREPEND_OFFSET].id;\n                }, endReached: endReached, firstItemIndex: PREPEND_OFFSET - numItemsPrepended, followOutput: followOutput, increaseViewportBy: { bottom: 200, top: 0 }, initialTopMostItemIndex: calculateInitialTopMostItemIndex(processedMessages, highlightedMessageId), itemContent: function (i) { return messageRenderer(processedMessages, i); }, itemSize: fractionalItemSize, key: messageSetKey, overscan: overscan, ref: virtuoso, startReached: startReached, style: { overflowX: 'hidden' }, totalCount: processedMessages.length }, additionalVirtuosoProps, (scrollSeekPlaceHolder ? { scrollSeek: scrollSeekPlaceHolder } : {}), (defaultItemHeight ? { defaultItemHeight: defaultItemHeight } : {})))),\n        React.createElement(MessageListNotifications, { hasNewMessages: newMessagesNotification, isNotAtLatestMessageSet: hasMoreNewer, MessageNotification: MessageNotification, notifications: notifications, scrollToBottom: scrollToBottom }),\n        giphyPreviewMessage && React.createElement(GiphyPreviewMessage, { message: giphyPreviewMessage })));\n};\n/**\n * The VirtualizedMessageList component renders a list of messages in a virtualized list.\n * It is a consumer of the React contexts set in [Channel](https://github.com/GetStream/stream-chat-react/blob/master/src/components/Channel/Channel.tsx).\n */\nexport function VirtualizedMessageList(props) {\n    var _a = useChannelActionContext('VirtualizedMessageList'), jumpToLatestMessage = _a.jumpToLatestMessage, loadMore = _a.loadMore, loadMoreNewer = _a.loadMoreNewer;\n    var _b = useChannelStateContext('VirtualizedMessageList'), channel = _b.channel, hasMore = _b.hasMore, hasMoreNewer = _b.hasMoreNewer, highlightedMessageId = _b.highlightedMessageId, loadingMore = _b.loadingMore, loadingMoreNewer = _b.loadingMoreNewer, contextMessages = _b.messages, notifications = _b.notifications, suppressAutoscroll = _b.suppressAutoscroll;\n    var messages = props.messages || contextMessages;\n    return (React.createElement(VirtualizedMessageListWithContext, __assign({ channel: channel, hasMore: !!hasMore, hasMoreNewer: !!hasMoreNewer, highlightedMessageId: highlightedMessageId, jumpToLatestMessage: jumpToLatestMessage, loadingMore: !!loadingMore, loadingMoreNewer: !!loadingMoreNewer, loadMore: loadMore, loadMoreNewer: loadMoreNewer, messages: messages, notifications: notifications, suppressAutoscroll: suppressAutoscroll }, props)));\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}